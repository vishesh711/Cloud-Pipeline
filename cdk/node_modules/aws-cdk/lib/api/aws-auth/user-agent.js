"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.defaultCliUserAgent = defaultCliUserAgent;
const path = require("path");
const util_1 = require("./util");
const util_2 = require("../../util");
/**
 * Find the package.json from the main toolkit.
 *
 * If we can't read it for some reason, try to do something reasonable anyway.
 * Fall back to argv[1], or a standard string if that is undefined for some reason.
 */
function defaultCliUserAgent() {
    var _a, _b, _c, _d;
    const root = (0, util_2.bundledPackageRootDir)(__dirname, false);
    const pkg = JSON.parse((_a = (root ? (0, util_1.readIfPossible)(path.join(root, 'package.json')) : undefined)) !== null && _a !== void 0 ? _a : '{}');
    const name = (_b = pkg.name) !== null && _b !== void 0 ? _b : path.basename((_c = process.argv[1]) !== null && _c !== void 0 ? _c : 'cdk-cli');
    const version = (_d = pkg.version) !== null && _d !== void 0 ? _d : '<unknown>';
    return `${name}/${version}`;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXNlci1hZ2VudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInVzZXItYWdlbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFTQSxrREFNQztBQWZELDZCQUE2QjtBQUM3QixpQ0FBd0M7QUFDeEMscUNBQW1EO0FBQ25EOzs7OztHQUtHO0FBQ0gsU0FBZ0IsbUJBQW1COztJQUNqQyxNQUFNLElBQUksR0FBRyxJQUFBLDRCQUFxQixFQUFDLFNBQVMsRUFBRSxLQUFLLENBQUMsQ0FBQztJQUNyRCxNQUFNLEdBQUcsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQUEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUEscUJBQWMsRUFBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxjQUFjLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsbUNBQUksSUFBSSxDQUFDLENBQUM7SUFDckcsTUFBTSxJQUFJLEdBQUcsTUFBQSxHQUFHLENBQUMsSUFBSSxtQ0FBSSxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQUEsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsbUNBQUksU0FBUyxDQUFDLENBQUM7SUFDckUsTUFBTSxPQUFPLEdBQUcsTUFBQSxHQUFHLENBQUMsT0FBTyxtQ0FBSSxXQUFXLENBQUM7SUFDM0MsT0FBTyxHQUFHLElBQUksSUFBSSxPQUFPLEVBQUUsQ0FBQztBQUM5QixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCB7IHJlYWRJZlBvc3NpYmxlIH0gZnJvbSAnLi91dGlsJztcbmltcG9ydCB7IGJ1bmRsZWRQYWNrYWdlUm9vdERpciB9IGZyb20gJy4uLy4uL3V0aWwnO1xuLyoqXG4gKiBGaW5kIHRoZSBwYWNrYWdlLmpzb24gZnJvbSB0aGUgbWFpbiB0b29sa2l0LlxuICpcbiAqIElmIHdlIGNhbid0IHJlYWQgaXQgZm9yIHNvbWUgcmVhc29uLCB0cnkgdG8gZG8gc29tZXRoaW5nIHJlYXNvbmFibGUgYW55d2F5LlxuICogRmFsbCBiYWNrIHRvIGFyZ3ZbMV0sIG9yIGEgc3RhbmRhcmQgc3RyaW5nIGlmIHRoYXQgaXMgdW5kZWZpbmVkIGZvciBzb21lIHJlYXNvbi5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRlZmF1bHRDbGlVc2VyQWdlbnQoKSB7XG4gIGNvbnN0IHJvb3QgPSBidW5kbGVkUGFja2FnZVJvb3REaXIoX19kaXJuYW1lLCBmYWxzZSk7XG4gIGNvbnN0IHBrZyA9IEpTT04ucGFyc2UoKHJvb3QgPyByZWFkSWZQb3NzaWJsZShwYXRoLmpvaW4ocm9vdCwgJ3BhY2thZ2UuanNvbicpKSA6IHVuZGVmaW5lZCkgPz8gJ3t9Jyk7XG4gIGNvbnN0IG5hbWUgPSBwa2cubmFtZSA/PyBwYXRoLmJhc2VuYW1lKHByb2Nlc3MuYXJndlsxXSA/PyAnY2RrLWNsaScpO1xuICBjb25zdCB2ZXJzaW9uID0gcGtnLnZlcnNpb24gPz8gJzx1bmtub3duPic7XG4gIHJldHVybiBgJHtuYW1lfS8ke3ZlcnNpb259YDtcbn1cbiJdfQ==